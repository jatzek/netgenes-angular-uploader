!function(angular){angular.module("netgenes.$ngUploader",[]).service("$ngUploader",function(){function Upload(conf){this.config={};var defaults={multipleFiles:!1,acceptFiles:null,url:null,additionalData:{},fileFieldName:"file",responseType:"json",headers:{},onSuccess:angular.noop,onError:angular.noop,onProgress:angular.noop};if(Object.assign(this.config,defaults,conf),null===this.config.url)throw new Error("Upload Endpoint url must be specified!");var successCallback=function(event){document.body.removeChild(handlerInput),this.config.onSuccess(event)}.bind(this),errorCallback=function(event){document.body.removeChild(handlerInput),this.config.onError(event)}.bind(this),progressCallback=function(event){this.config.onProgress(event)}.bind(this),changeHandler=function(changeEvent){var files,xhr,formData,additionalData,fileFieldName,responseType,endpointUrl,requestHeaders;if(0!==event.target.files.length){files=event.target.files,additionalData=this.config.additionalData,fileFieldName=this.config.fileFieldName,responseType=this.config.responseType,endpointUrl=this.config.url,requestHeaders=this.config.headers,formData=new FormData;for(var p in additionalData)additionalData.hasOwnProperty(p)&&formData.append(p,additionalData[p]);for(var i in files)files.hasOwnProperty(i)&&formData.append(fileFieldName,files[i]);xhr=new XMLHttpRequest,xhr.responseType=responseType,xhr.addEventListener("load",successCallback),xhr.addEventListener("error",errorCallback),xhr.upload.addEventListener("progress",progressCallback),xhr.open("POST",endpointUrl);for(var h in requestHeaders)requestHeaders.hasOwnProperty(h)&&xhr.setRequestHeader(h,requestHeaders[h]);xhr.send(formData)}}.bind(this),handlerInput=document.createElement("input");handlerInput.setAttribute("type","file"),handlerInput.style.display="none",handlerInput.addEventListener("change",changeHandler),this.config.acceptFiles&&handlerInput.setAttribute("accept",this.config.acceptFiles),this.config.multipleFiles&&handlerInput.setAttribute("multiple",!0),document.body.appendChild(handlerInput);var click=document.createEvent("MouseEvents");click.initEvent("click",!0,!0),click.synthetic=!0,handlerInput.dispatchEvent(click)}function NgUploader(){}return NgUploader.prototype.upload=function(config){return new Upload(config)},new NgUploader})}(angular);